"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[77],{8077:(Z,x,d)=>{d.r(x),d.d(x,{SupportsModule:()=>L});var l=d(6895),m=d(7136),e=d(1571),h=d(7241),f=d(5830),g=d(502),u=d(433);const y=["scrollMe"],b=["messages"];function C(o,a){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16),e._UZ(2,"img",17),e.TgZ(3,"label",18),e._uU(4),e._UZ(5,"br"),e.TgZ(6,"span",19),e._uU(7),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("src",t.api.imageUrl+t.avtar,e.LSH),e.xp6(2),e.hij("",t.name," "),e.xp6(3),e.Oqu(t.type)}}function k(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,v=e.oxw();return e.KtG(v.chatUser(s.receiver_id,s.receiver_type,s.receiver_name+" "+s.receiver_last_name))}),e._UZ(1,"img",17),e.TgZ(2,"label",18),e._uU(3),e.qZA()()}if(2&o){const t=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("src",n.api.imageUrl+t.receiver_cover,e.LSH),e.xp6(2),e.hij("",t.receiver_name+" "+t.receiver_last_name," ")}}function _(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,v=e.oxw();return e.KtG(v.chatUser(s.sender_id,s.sender_type,s.sender_first_name+" "+s.sender_last_name))}),e._UZ(1,"img",17),e.TgZ(2,"label",18),e._uU(3),e.qZA()()}if(2&o){const t=e.oxw().$implicit,n=e.oxw();e.xp6(1),e.Q6J("src",n.api.imageUrl+t.sender_cover,e.LSH),e.xp6(2),e.hij("",t.sender_first_name+" "+t.sender_last_name," ")}}function w(o,a){if(1&o&&(e.TgZ(0,"div",20),e.YNc(1,k,4,2,"div",21),e.YNc(2,_,4,2,"div",21),e.qZA()),2&o){const t=a.$implicit,n=e.oxw();e.Q6J("id",n.uid==t.sender_id?t.sender_id:t.uid),e.xp6(1),e.Q6J("ngIf",n.uid==t.sender_id),e.xp6(1),e.Q6J("ngIf",n.uid!=t.sender_id)}}function O(o,a){1&o&&(e.TgZ(0,"div",23)(1,"div",24),e._UZ(2,"ngx-skeleton-loader",25),e.qZA()())}function M(o,a){if(1&o&&(e.TgZ(0,"div",29)(1,"div",30)(2,"div",31),e._uU(3),e.qZA()(),e._UZ(4,"div",32),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.message," ")}}function S(o,a){if(1&o&&(e.TgZ(0,"div",33)(1,"div",30)(2,"div",31),e._uU(3),e.qZA()(),e._UZ(4,"div",34),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(3),e.hij(" ",t.message," ")}}function P(o,a){if(1&o&&(e.TgZ(0,"span",null,26),e.YNc(2,M,5,1,"div",27),e.YNc(3,S,5,1,"div",28),e.qZA()),2&o){const t=a.$implicit,n=e.oxw();e.xp6(2),e.Q6J("ngIf",t.sender_id==n.uid),e.xp6(1),e.Q6J("ngIf",t.sender_id!=n.uid)}}function i(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",35)(1,"input",36),e.NdJ("ngModelChange",function(s){e.CHM(t);const v=e.oxw();return e.KtG(v.message=s)})("keydown.enter",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.send())}),e.qZA(),e.TgZ(2,"button",37),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.send())}),e._uU(3),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngModel",t.message)("placeholder",t.util.translate("Send Message")),e.xp6(2),e.hij(" ",t.util.translate("Send")," ")}}const r=[{path:"",component:(()=>{class o{constructor(t,n){this.util=t,this.api=n,this.users=[],this.dummy=[],this.dummyList=Array(5),this.messages=[],this.roomId="",this.uid=parseInt(localStorage.getItem("uid")||"0"),this.getList(),this.util.successEject().subscribe(()=>{clearInterval(this.interval)})}canDeactivate(){console.log("ok")}getList(){this.users=[],this.dummy=[],this.getChatList()}getChatList(){this.dummyList=Array(5),this.api.post_private("v1/chats/getChatListBUid",{id:this.uid}).then(t=>{console.log(t),this.dummyList=[],t&&t.status&&t.data&&t.data.length&&(this.users=t.data)},t=>{console.log(t),this.dummyList=[],this.util.apiErrorHandler(t)}).catch(t=>{console.log(t),this.dummyList=[],this.util.apiErrorHandler(t)})}ngOnInit(){}search(t){console.log(t)}getChatRooms(){this.api.post_private("v1/chats/getChatRooms",{sender_id:this.uid,receiver_id:this.id}).then(n=>{console.log(n),n&&n.status&&200==n.status?(n&&n.data&&n.data.id?this.roomId=n.data.id:n&&n.data2&&n.data2.id&&(this.roomId=n.data2.id),this.getMessageList(),this.interval=setInterval(()=>{console.log("calling in interval"),this.getMessageList()},12e3)):this.createChatRooms()},n=>{console.log("error",n),this.createChatRooms()}).catch(n=>{this.createChatRooms(),console.log("error",n)})}createChatRooms(){this.api.post_private("v1/chats/createChatRooms",{sender_id:this.uid,receiver_id:this.id,status:1}).then(n=>{console.log(n),n&&n.status&&200==n.status&&n.data&&(this.roomId=n.data.id,this.getMessageList(),this.interval=setInterval(()=>{console.log("calling in interval"),this.getMessageList()},12e3))},n=>{console.log("error",n)}).catch(n=>{console.log("error",n)})}chatUser(t,n,s){console.log(t,n,s),this.id=t,this.name=s,this.getChatRooms()}getMessageList(){this.api.post_private("v1/chats/getById",{room_id:this.roomId}).then(t=>{console.log(t),t&&t.status&&200==t.status&&t.data.length&&(this.messages=t.data)},t=>{console.log(t)}).catch(t=>{console.log(t)})}send(){if(console.log(this.message),!this.message||""==this.message)return!1;const t=this.message;this.message="",this.api.post_private("v1/chats/sendMessage",{room_id:this.roomId,uid:this.uid,sender_id:this.uid,message:t,message_type:0,status:1,reported:0}).then(s=>{console.log(s),s&&200==s.status&&this.getMessageList()},s=>{console.log(s)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.f),e.Y36(f.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-supports"]],viewQuery:function(t,n){if(1&t&&(e.Gf(y,5),e.Gf(b,5)),2&t){let s;e.iGM(s=e.CRH())&&(n.myScrollContainer=s.first),e.iGM(s=e.CRH())&&(n.messagesList=s)}},hostBindings:function(t,n){1&t&&e.NdJ("beforeunload",function(){return n.canDeactivate()},!1,e.Jf7)},decls:17,vars:7,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"card-body","reset-table","p-t-0"],[1,"form-group","row",2,"height","60vh","border","1px solid lightgray"],[1,"col-sm-4",2,"height","60vh","overflow","scroll","padding","0px","border-right","1px solid lightgray"],["style","border-bottom: 1px solid lightgray;padding: 10px;margin: 10px;background: lightcoral;color: white;",4,"ngIf"],["style","border-bottom: 1px solid lightgray;padding: 10px;margin: 10px;",3,"id",4,"ngFor","ngForOf"],["style","border-bottom: 1px solid lightgray;padding: 10px;margin: 10px;",4,"ngFor","ngForOf"],[1,"col-sm-8",2,"height","60vh","overflow","scroll","position","relative"],[1,"lower_div",3,"scrollTop"],["scrollMe",""],[4,"ngFor","ngForOf"],["style","position: absolute;bottom: 10px;width: 90%;display: flex;flex-direction: row;justify-content: space-between;align-items: center;",4,"ngIf"],[2,"border-bottom","1px solid lightgray","padding","10px","margin","10px","background","lightcoral","color","white"],[2,"display","flex"],["onError","this.src='assets/img/user.png'","alt","chat-user",1,"img-responsive",2,"height","40px","width","40px","border-radius","50%",3,"src"],[2,"margin-left","10px"],[2,"font-size",".6rem","color","white"],[2,"border-bottom","1px solid lightgray","padding","10px","margin","10px",3,"id"],["style","display:flex;align-items: center;",3,"click",4,"ngIf"],[2,"display","flex","align-items","center",3,"click"],[2,"border-bottom","1px solid lightgray","padding","10px","margin","10px"],[2,"display","flex","align-items","center"],["count","1","appearance","line",2,"width","100%"],["messages",""],["class","main_div_right",4,"ngIf"],["class","main_div_left",4,"ngIf"],[1,"main_div_right"],[1,"msg_div"],[1,"inner_msg"],[1,"tri_right"],[1,"main_div_left"],[1,"tri_left"],[2,"position","absolute","bottom","10px","width","90%","display","flex","flex-direction","row","justify-content","space-between","align-items","center"],["type","text",1,"form-control","form-control-round",3,"ngModel","placeholder","ngModelChange","keydown.enter"],[1,"btn","btn-danger","btn-icon",2,"margin-left","10px",3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5"),e._uU(5),e.qZA()(),e.TgZ(6,"div",4)(7,"div",5)(8,"div",6),e.YNc(9,C,8,3,"div",7),e.YNc(10,w,3,3,"div",8),e.YNc(11,O,3,0,"div",9),e.qZA(),e.TgZ(12,"div",10)(13,"div",11,12),e.YNc(15,P,4,2,"span",13),e.qZA(),e.YNc(16,i,4,3,"div",14),e.qZA()()()()()()),2&t){const s=e.MAs(14);e.xp6(5),e.hij("",n.util.translate("Support")," "),e.xp6(4),e.Q6J("ngIf",n.selectedId),e.xp6(1),e.Q6J("ngForOf",n.users),e.xp6(1),e.Q6J("ngForOf",n.dummyList),e.xp6(2),e.Q6J("scrollTop",s.scrollHeight),e.xp6(2),e.Q6J("ngForOf",n.messages),e.xp6(1),e.Q6J("ngIf",n.id)}},dependencies:[l.sg,l.O5,g.xr,u.Fj,u.JJ,u.On],styles:['@charset "UTF-8";.lower_div[_ngcontent-%COMP%]{padding:20px;height:50vh;overflow:scroll}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end;position:relative}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:80%;margin-bottom:15px}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]   .inner_msg[_ngcontent-%COMP%]{background-color:#f0eff5;padding:10px;border-radius:5px}.lower_div[_ngcontent-%COMP%]   .main_div_right[_ngcontent-%COMP%]   .tri_right[_ngcontent-%COMP%]{width:0;height:0;position:absolute;border-top:10px solid #f0eff5;border-left:10px solid transparent;bottom:10px}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-start;position:relative}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;width:80%;margin-bottom:15px}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .msg_div[_ngcontent-%COMP%]   .inner_msg[_ngcontent-%COMP%]{background-color:gray;padding:10px;border-radius:5px;color:#fff}.lower_div[_ngcontent-%COMP%]   .main_div_left[_ngcontent-%COMP%]   .tri_left[_ngcontent-%COMP%]{width:0;height:0;position:absolute;border-top:10px solid gray;border-right:10px solid transparent;bottom:10px}']}),o})()}];let c=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.Bz.forChild(r),m.Bz]}),o})();var T=d(8423);let L=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[l.ez,c,T.ef,g.hx,u.u5]}),o})()},502:(Z,x,d)=>{d.d(x,{xr:()=>S,hx:()=>P});var l=d(1571);const m=typeof performance<"u"&&typeof performance.now<"u"&&"function"==typeof performance.mark&&"function"==typeof performance.measure&&("function"==typeof performance.clearMarks||"function"==typeof performance.clearMeasures),e=typeof PerformanceObserver<"u"&&typeof PerformanceObserver.prototype<"u"&&"function"==typeof PerformanceObserver.prototype.constructor,h="[object process]"===Object.prototype.toString.call(typeof process<"u"?process:0);let f={},g={};const u=()=>m?performance.now():Date.now(),y=i=>{f[i]=void 0,g[i]&&(g[i]=void 0),m&&(h||performance.clearMeasures(i),performance.clearMarks(i))},b=i=>{if(m){if(h&&e){const p=new PerformanceObserver(r=>{g[i]=r.getEntries().find(c=>c.name===i),p.disconnect()});p.observe({entryTypes:["measure"]})}performance.mark(i)}f[i]=u()},C=(i,p)=>{try{const r=f[i];return m?(p||performance.mark(`${i}-end`),performance.measure(i,i,p||`${i}-end`),h?g[i]?g[i]:r?{duration:u()-r,startTime:r,entryType:"measure",name:i}:{}:performance.getEntriesByName(i).pop()||{}):r?{duration:u()-r,startTime:r,entryType:"measure",name:i}:{}}catch{return{}}finally{y(i),y(p||`${i}-end`)}};var _=d(6895);const w=function(i,p,r,c){return{circle:i,progress:p,"progress-dark":r,pulse:c}};function O(i,p){if(1&i&&l._UZ(0,"span",1),2&i){const r=l.oxw();l.Q6J("ngClass",l.l5B(4,w,"circle"===r.appearance,"progress"===r.animation,"progress-dark"===r.animation,"pulse"===r.animation))("ngStyle",r.theme),l.uIk("aria-label",r.ariaLabel)("aria-valuetext",r.loadingText)}}const M=new l.OlP("ngx-skeleton-loader.config");let S=(()=>{class i{constructor(r){const{appearance:c="line",animation:T="progress",theme:L=null,loadingText:o="Loading...",count:a=1,ariaLabel:t="loading"}=r||{};this.appearance=c,this.animation=T,this.theme=L,this.loadingText=o,this.count=a,this.items=[],this.ariaLabel=t}ngOnInit(){b("NgxSkeletonLoader:Rendered"),b("NgxSkeletonLoader:Loaded"),this.validateInputValues()}validateInputValues(){/^\d+$/.test(`${this.count}`)||((0,l.X6Q)()&&console.error("`NgxSkeletonLoaderComponent` need to receive 'count' a numeric value. Forcing default to \"1\"."),this.count=1),this.items.length=this.count;const r=["progress","progress-dark","pulse","false"];-1===r.indexOf(String(this.animation))&&((0,l.X6Q)()&&console.error(`\`NgxSkeletonLoaderComponent\` need to receive 'animation' as: ${r.join(", ")}. Forcing default to "progress".`),this.animation="progress"),-1===["circle","line",""].indexOf(String(this.appearance))&&((0,l.X6Q)()&&console.error("`NgxSkeletonLoaderComponent` need to receive 'appearance' as: circle or line or empty string. Forcing default to \"''\"."),this.appearance="")}ngOnChanges(r){["count","animation","appearance"].find(c=>r[c]&&(r[c].isFirstChange()||r[c].previousValue===r[c].currentValue))||this.validateInputValues()}ngAfterViewInit(){C("NgxSkeletonLoader:Rendered")}ngOnDestroy(){C("NgxSkeletonLoader:Loaded")}}return i.\u0275fac=function(r){return new(r||i)(l.Y36(M,8))},i.\u0275cmp=l.Xpm({type:i,selectors:[["ngx-skeleton-loader"]],inputs:{count:"count",loadingText:"loadingText",appearance:"appearance",animation:"animation",ariaLabel:"ariaLabel",theme:"theme"},features:[l.TTD],decls:1,vars:1,consts:[["class","loader","aria-busy","true","aria-valuemin","0","aria-valuemax","100","role","progressbar","tabindex","0",3,"ngClass","ngStyle",4,"ngFor","ngForOf"],["aria-busy","true","aria-valuemin","0","aria-valuemax","100","role","progressbar","tabindex","0",1,"loader",3,"ngClass","ngStyle"]],template:function(r,c){1&r&&l.YNc(0,O,1,9,"span",0),2&r&&l.Q6J("ngForOf",c.items)},dependencies:[_.sg,_.mk,_.PC],styles:['.loader[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;position:relative;background:#eff1f6 no-repeat;border-radius:4px;width:100%;height:20px;display:inline-block;margin-bottom:10px;will-change:transform}.loader[_ngcontent-%COMP%]:after, .loader[_ngcontent-%COMP%]:before{box-sizing:border-box}.loader.circle[_ngcontent-%COMP%]{width:40px;height:40px;margin:5px;border-radius:50%}.loader.progress[_ngcontent-%COMP%], .loader.progress-dark[_ngcontent-%COMP%]{transform:translate(0)}.loader.progress[_ngcontent-%COMP%]:after, .loader.progress[_ngcontent-%COMP%]:before, .loader.progress-dark[_ngcontent-%COMP%]:after, .loader.progress-dark[_ngcontent-%COMP%]:before{box-sizing:border-box}.loader.progress[_ngcontent-%COMP%]:before, .loader.progress-dark[_ngcontent-%COMP%]:before{-webkit-animation:progress 2s ease-in-out infinite;animation:progress 2s ease-in-out infinite;background-size:200px 100%;position:absolute;z-index:1;top:0;left:0;width:200px;height:100%;content:""}.loader.progress[_ngcontent-%COMP%]:before{background-image:linear-gradient(90deg,rgba(255,255,255,0),rgba(255,255,255,.6),rgba(255,255,255,0))}.loader.progress-dark[_ngcontent-%COMP%]:before{background-image:linear-gradient(90deg,transparent,rgba(0,0,0,.2),transparent)}.loader.pulse[_ngcontent-%COMP%]{-webkit-animation:pulse 1.5s cubic-bezier(.4,0,.2,1) infinite;animation:pulse 1.5s cubic-bezier(.4,0,.2,1) infinite;-webkit-animation-delay:.5s;animation-delay:.5s}@media (prefers-reduced-motion: reduce){.loader.pulse[_ngcontent-%COMP%], .loader.progress-dark[_ngcontent-%COMP%], .loader.progress[_ngcontent-%COMP%]{-webkit-animation:none;animation:none}.loader.progress[_ngcontent-%COMP%], .loader.progress-dark[_ngcontent-%COMP%]{background-image:none}}@-webkit-keyframes progress{0%{transform:translate(-200px)}to{transform:translate(calc(200px + 100vw))}}@keyframes progress{0%{transform:translate(-200px)}to{transform:translate(calc(200px + 100vw))}}@-webkit-keyframes pulse{0%{opacity:1}50%{opacity:.4}to{opacity:1}}@keyframes pulse{0%{opacity:1}50%{opacity:.4}to{opacity:1}}'],changeDetection:0}),i})(),P=(()=>{class i{static forRoot(r){return{ngModule:i,providers:[{provide:M,useValue:r}]}}}return i.\u0275fac=function(r){return new(r||i)},i.\u0275mod=l.oAB({type:i}),i.\u0275inj=l.cJS({imports:[[_.ez]]}),i})()}}]);