"use strict";(self.webpackChunkcoreui_free_angular_admin_template=self.webpackChunkcoreui_free_angular_admin_template||[]).push([[683],{5683:(Q,h,a)=>{a.r(h),a.d(h,{OffersModule:()=>H});var p=a(6895),g=a(7136),Z=a(5439),v=a(5226),f=a.n(v),t=a(1571),M=a(7241),O=a(5830),m=a(388),u=a(433),_=a(8423),c=a(4333),C=a(502),b=a(4980),T=a(324);const A=["myModal3"];function y(o,r){if(1&o){const i=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.createOffer())}),t.TgZ(1,"span"),t._uU(2),t.qZA()()}if(2&o){const i=t.oxw();t.xp6(2),t.hij(" ",i.util.translate("Save")," ")}}function w(o,r){if(1&o){const i=t.EpF();t.TgZ(0,"button",49),t.NdJ("click",function(){t.CHM(i);const n=t.oxw();return t.KtG(n.updateOffer())}),t.TgZ(1,"span"),t._uU(2),t.qZA()()}if(2&o){const i=t.oxw();t.xp6(2),t.hij(" ",i.util.translate("Update")," ")}}function q(o,r){if(1&o&&(t.TgZ(0,"div",50)(1,"label"),t._uU(2),t.qZA()()),2&o){const i=t.oxw();t.xp6(2),t.Oqu(i.util.translate("No Data Found.."))}}function x(o,r){1&o&&(t.TgZ(0,"td"),t._UZ(1,"ngx-skeleton-loader",51),t.qZA())}const U=function(){return[1,2,3,4,5,6]};function J(o,r){1&o&&(t.TgZ(0,"tr"),t.YNc(1,x,2,0,"td",31),t.qZA()),2&o&&(t.xp6(1),t.Q6J("ngForOf",t.DdM(1,U)))}function N(o,r){if(1&o){const i=t.EpF();t.TgZ(0,"tr")(1,"th",52),t._uU(2),t.qZA(),t.TgZ(3,"td")(4,"label",53),t._uU(5),t.qZA()(),t.TgZ(6,"td")(7,"span"),t._uU(8),t.qZA()(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td",54),t._uU(12),t.qZA(),t.TgZ(13,"td")(14,"div",55)(15,"c-badge",56),t.NdJ("click",function(){const l=t.CHM(i).$implicit,s=t.oxw();return t.KtG(s.statusUpdate(l))}),t._uU(16),t.qZA(),t.TgZ(17,"c-badge",57),t.NdJ("click",function(){const l=t.CHM(i).$implicit,s=t.oxw();return t.KtG(s.updateInfo(l))}),t._uU(18),t.qZA(),t.TgZ(19,"c-badge",58),t.NdJ("click",function(){const l=t.CHM(i).$implicit,s=t.oxw();return t.KtG(s.deleteItem(l.id))}),t._uU(20),t.qZA()()()()}if(2&o){const i=r.$implicit,e=t.oxw();t.xp6(2),t.hij(" ",i.id," "),t.xp6(3),t.hij(" ",i.code," "),t.xp6(3),t.AsE(" ",i.discount," ","per"==i.type?"%":e.util.appSettings.currencySymbol," "),t.xp6(2),t.hij(" ",e.getDate(i.date_time)," "),t.xp6(2),t.hij(" ",i.details," "),t.xp6(3),t.Tol(1==i.status?"me-1 badge bg-success":"me-1 badge bg-dark"),t.Q6J("color",1==i.status?"success":"dark"),t.xp6(1),t.hij(" ",e.util.translate(1==i.status?"Active":"Deactived")," "),t.xp6(2),t.hij(" ",e.util.translate("View")," "),t.xp6(2),t.hij(" ",e.util.translate("Delete")," ")}}function D(o,r){if(1&o){const i=t.EpF();t.TgZ(0,"div")(1,"pagination-controls",59),t.NdJ("pageChange",function(n){t.CHM(i);const l=t.oxw();return t.KtG(l.page=n)}),t.qZA()()}}const d=function(){return{standalone:!0}},k=function(o){return{id:"pagin1",itemsPerPage:10,currentPage:o}},S=[{path:"",component:(()=>{class o{constructor(i,e){this.util=i,this.api=e,this.list=[],this.dummy=[],this.dummyList=[],this.name="",this.off="",this.type="per",this.min="",this.date_time="",this.descriptions="",this.upto="",this.id="",this.isNew=!0,this.page=1,this.dropdownList=[],this.selectedItems=[],this.dropdownSettings={},this.submited=!1,this.resetChanges=()=>{this.list=this.dummyList},this.dropdownSettings={singleSelection:!1,idField:"uid",textField:"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",allowSearchFilter:!0},this.getStore(),this.getAll()}ngOnInit(){}getAll(){this.list=[],this.dummy=Array(5),this.api.get_private("v1/offers/getAll").then(i=>{console.log(i),this.dummy=[],i&&i.status&&200==i.status&&i.data&&(this.list=i.data,this.dummyList=i.data)},i=>{console.log(i),this.dummy=[],this.util.apiErrorHandler(i)}).catch(i=>{console.log(i),this.dummy=[],this.util.apiErrorHandler(i)})}getStore(){this.api.get_private("v1/stores/getAll").then(i=>{console.log(i),i&&i.status&&200==i.status&&i.data&&(this.dropdownList=i.data)},i=>{console.log(i),this.util.apiErrorHandler(i)}).catch(i=>{console.log(i),this.util.apiErrorHandler(i)})}createOffer(){console.log(this.selectedItems);const i=[...new Set(this.selectedItems.map(n=>n.uid))];if(console.log(i),this.submited=!0,null==this.name||""==this.name||null==this.off||""==this.off||null==this.min||""==this.min||null==this.upto||""==this.upto||null==this.date_time||""==this.date_time||null==this.descriptions||""==this.descriptions)return this.util.error("All Fields are required"),!1;if(0==this.selectedItems.length)return this.util.error("Please select restaurant"),!1;const e={code:this.name,discount:this.off,type:this.type,min:this.min,expire:this.date_time,details:this.descriptions,upto:this.upto,available:i.join(",")};this.util.show(),this.api.post_private("v1/offers/save",e).then(n=>{console.log(n),this.util.hide(),n&&n.status&&200==n.status&&n.data&&(this.getAll(),this.cleanData())},n=>{console.log(n),this.util.hide(),this.util.apiErrorHandler(n)}).catch(n=>{console.log(n),this.util.hide(),this.util.apiErrorHandler(n)})}updateOffer(){console.log(this.selectedItems),this.submited=!0;const i=[...new Set(this.selectedItems.map(n=>n.uid))];if(console.log(i),null==this.name||""==this.name||null==this.off||""==this.off||null==this.min||""==this.min||null==this.upto||""==this.upto||null==this.date_time||""==this.date_time||null==this.descriptions||""==this.descriptions)return this.util.error("All Fields are required"),!1;if(0==this.selectedItems.length)return this.util.error("Please select restaurant"),!1;const e={code:this.name,discount:this.off,type:this.type,min:this.min,expire:this.date_time,details:this.descriptions,upto:this.upto,available:i.join(","),id:this.id};this.util.show(),this.api.post_private("v1/offers/update",e).then(n=>{console.log(n),this.util.hide(),n&&n.status&&200==n.status&&n.data&&(this.getAll(),this.cleanData())},n=>{console.log(n),this.util.hide(),this.util.apiErrorHandler(n)}).catch(n=>{console.log(n),this.util.hide(),this.util.apiErrorHandler(n)})}cleanData(){this.selectedItems=[],this.isNew=!0,this.name="",this.off="",this.type="per",this.min="",this.date_time="",this.descriptions="",this.upto="",this.submited=!1}importCSV(){this.myModal3.show()}saveType(){this.myModal3.hide()}uploadCSV(i){console.log("fle",i),0!=i.length&&null!=i[0].type.match(/text\/*/)&&(i?(console.log("ok"),this.util.show(),this.api.uploaCSV(i,"v1/offers/importData").subscribe(n=>{console.log("==>>>>>>",n.data),this.util.hide(),this.myModal3.hide(),this.util.success("Uploaded"),this.getAll()},n=>{console.log(n),this.util.hide(),this.util.apiErrorHandler(n)})):console.log("no"))}downloadSample(){window.open("assets/sample/offers.csv","_blank")}exportCSV(){let i=[];this.list.forEach(n=>{const l={id:this.util.replaceWithDot(n.id),available:this.util.replaceWithDot(n.available),code:this.util.replaceWithDot(n.code),details:this.util.replaceWithDot(n.details),discount:this.util.replaceWithDot(n.discount),expire:this.util.replaceWithDot(n.expire),min:this.util.replaceWithDot(n.min),type:this.util.replaceWithDot(n.type),upto:this.util.replaceWithDot(n.upto),status:this.util.replaceWithDot(n.status)};i.push(l)}),this.util.downloadFile(i,"offers",["id","available","code","details","discount","expire","min","type","upto","status"])}search(i){this.resetChanges(),console.log("string",i),this.list=this.filterItems(i)}filterItems(i){return this.list.filter(e=>e.code.toLowerCase().indexOf(i.toLowerCase())>-1)}setFilteredItems(){console.log("clear"),this.list=[],this.list=this.dummyList}getDate(i){return Z(i).format("lll")}statusUpdate(i){console.log(i),f().fire({title:this.util.translate("Are you sure?"),text:this.util.translate("To update this item?"),icon:"question",showConfirmButton:!0,confirmButtonText:this.util.translate("Yes"),showCancelButton:!0,cancelButtonText:this.util.translate("Cancel"),backdrop:!1,background:"white"}).then(e=>{if(e&&e.value){console.log("update it");const n={id:i.id,status:0==i.status?1:0};this.util.show(),this.api.post_private("v1/offers/update",n).then(l=>{this.util.hide(),console.log("+++++++++++++++",l),l&&l.status&&200==l.status&&l.success&&(this.util.success(this.util.translate("Status Updated !")),this.getAll())},l=>{this.util.hide(),console.log("Error",l),this.util.apiErrorHandler(l)}).catch(l=>{this.util.hide(),console.log("Err",l),this.util.apiErrorHandler(l)})}})}deleteItem(i){console.log(i),f().fire({title:this.util.translate("Are you sure?"),text:this.util.translate("To delete this item?"),icon:"question",showConfirmButton:!0,confirmButtonText:this.util.translate("Yes"),showCancelButton:!0,cancelButtonText:this.util.translate("Cancel"),backdrop:!1,background:"white"}).then(e=>{e&&e.value&&(console.log("update it"),console.log(i),this.util.show(),this.api.post_private("v1/offers/delete",{id:i}).then(n=>{console.log(n),this.util.hide(),n&&n.status&&200==n.status&&this.getAll()}).catch(n=>{console.log(n),this.util.hide(),this.util.apiErrorHandler(n)}))})}updateInfo(i){if(console.log(i),this.isNew=!1,this.name=i.code,this.off=i.discount,this.type=i.type,this.min=i.min,this.date_time=i.expire,this.descriptions=i.details,this.upto=i.upto,this.submited=!1,this.id=i.id,console.log(i.available),""!=i.available){const e=i.available.split(",").map(Number);console.log(e),this.selectedItems=[],this.dropdownList.forEach(n=>{e.includes(n.uid)&&this.selectedItems.push({uid:n.uid,name:n.name})})}}}return o.\u0275fac=function(i){return new(i||o)(t.Y36(M.f),t.Y36(O.s))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-offers"]],viewQuery:function(i,e){if(1&i&&t.Gf(A,5),2&i){let n;t.iGM(n=t.CRH())&&(e.myModal3=n.first)}},decls:110,vars:81,consts:[["type","ball-scale-multiple"],[1,"animated","fadeIn"],[1,"row"],[1,"col-lg-4"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"col-sm-12"],["maxHeight","100",3,"placeholder","data","ngModel","settings","ngModelChange"],["type","text",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],["type","number",1,"form-control",3,"ngModel","placeholder","ngModelOptions","ngModelChange"],["name","select",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange"],["value","per"],["value","flat"],["type","date",1,"form-control",3,"ngModel","ngModelOptions","placeholder","ngModelChange"],["rows","5","cols","5",1,"form-control",3,"ngModel","ngModelOptions","placeholder","ngModelChange"],[1,"col-lg-12"],[1,"form-group"],[1,"d-flex","justify-content-start"],["type","button","class","btn btn-success",3,"click",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"col-lg-8"],[1,"card-header-actions"],["type","submit",1,"btn","btn-sm","btn-warning",2,"float","right","margin","0px 5px",3,"click"],["type","submit",1,"btn","btn-sm","btn-success",2,"float","right","margin","0px 5px",3,"click"],[1,"row","flex_row"],["type","text","id","name",1,"form-control","form-control-lg",3,"placeholder","input"],["class","error_div",4,"ngIf"],[1,"table","align-items-center","table-flush"],[1,"thead-light"],["scope","col"],[4,"ngFor","ngForOf"],[4,"ngIf"],["bsModal","","tabindex","-1","role","dialog","aria-labelledby","myModalLabel","aria-hidden","true",1,"modal","fade"],["myModal3","bs-modal"],["role","document",1,"modal-dialog","modal-warning"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","long_content"],[1,"form-group","row"],[1,"col-md-12"],["type","file","id","file-input","name","file-input","accept",".csv",3,"change"],["type","button",1,"btn","btn-warning",2,"float","right",3,"click"],[1,"fa","fa-cloud-download"],[1,"modal-footer"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"error_div"],["count","1","appearance","line"],["scope","row"],[2,"font-weight","bold"],[2,"width","150px","white-space","pre-wrap"],[1,"d-flex","align-items-center"],[3,"color","click"],["color","info",1,"me-1","badge","bg-info",3,"click"],["color","danger",1,"me-1","badge","bg-danger",3,"click"],["id","pagin1",3,"pageChange"]],template:function(i,e){if(1&i){const n=t.EpF();t._UZ(0,"ngx-spinner",0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t._uU(6),t.qZA(),t.TgZ(7,"div",6)(8,"div",2)(9,"div",7)(10,"label"),t._uU(11),t.qZA(),t.TgZ(12,"ng-multiselect-dropdown",8),t.NdJ("ngModelChange",function(s){return e.selectedItems=s}),t.qZA()(),t.TgZ(13,"div",7)(14,"label"),t._uU(15),t.qZA(),t.TgZ(16,"input",9),t.NdJ("ngModelChange",function(s){return e.name=s}),t.qZA()(),t.TgZ(17,"div",7)(18,"label"),t._uU(19),t.qZA(),t.TgZ(20,"input",10),t.NdJ("ngModelChange",function(s){return e.off=s}),t.qZA()(),t.TgZ(21,"div",7)(22,"label"),t._uU(23),t.qZA(),t.TgZ(24,"input",10),t.NdJ("ngModelChange",function(s){return e.min=s}),t.qZA()(),t.TgZ(25,"div",7)(26,"label"),t._uU(27),t.qZA(),t.TgZ(28,"input",10),t.NdJ("ngModelChange",function(s){return e.upto=s}),t.qZA()(),t.TgZ(29,"div",7)(30,"label"),t._uU(31),t.qZA(),t.TgZ(32,"select",11),t.NdJ("ngModelChange",function(s){return e.type=s}),t.TgZ(33,"option",12),t._uU(34,"%"),t.qZA(),t.TgZ(35,"option",13),t._uU(36),t.qZA()()(),t.TgZ(37,"div",7)(38,"label"),t._uU(39),t.qZA(),t.TgZ(40,"input",14),t.NdJ("ngModelChange",function(s){return e.date_time=s}),t.qZA()(),t.TgZ(41,"div",7)(42,"label"),t._uU(43),t.qZA(),t.TgZ(44,"textarea",15),t.NdJ("ngModelChange",function(s){return e.descriptions=s}),t.qZA()(),t.TgZ(45,"div",16)(46,"div",17)(47,"div",18),t.YNc(48,y,3,1,"button",19),t.YNc(49,w,3,1,"button",19),t._uU(50," \xa0 "),t.TgZ(51,"button",20),t.NdJ("click",function(){return e.cleanData()}),t._uU(52),t.qZA()()()()()()()(),t.TgZ(53,"div",21)(54,"div",4)(55,"div",5),t._uU(56),t.TgZ(57,"div",22)(58,"button",23),t.NdJ("click",function(){return e.importCSV()}),t._uU(59),t.qZA(),t._uU(60," \xa0 "),t.TgZ(61,"button",24),t.NdJ("click",function(){return e.exportCSV()}),t._uU(62),t.qZA()()(),t.TgZ(63,"div",6)(64,"div",25)(65,"div",16)(66,"input",26),t.NdJ("input",function(s){return e.search(s.target.value)}),t.qZA()()(),t.YNc(67,q,3,1,"div",27),t.TgZ(68,"table",28)(69,"thead",29)(70,"tr")(71,"th",30),t._uU(72),t.qZA(),t.TgZ(73,"th",30),t._uU(74),t.qZA(),t.TgZ(75,"th",30),t._uU(76),t.qZA(),t.TgZ(77,"th",30),t._uU(78),t.qZA(),t.TgZ(79,"th",30),t._uU(80),t.qZA(),t.TgZ(81,"th",30),t._uU(82),t.qZA()()(),t.TgZ(83,"tbody"),t.YNc(84,J,2,2,"tr",31),t.YNc(85,N,21,12,"tr",31),t.ALo(86,"paginate"),t.qZA()(),t.YNc(87,D,2,0,"div",32),t.qZA()()()()(),t.TgZ(88,"div",33,34)(90,"div",35)(91,"div",36)(92,"div",37)(93,"h5",38),t._uU(94),t.qZA(),t.TgZ(95,"button",39),t.NdJ("click",function(){t.CHM(n);const s=t.MAs(89);return t.KtG(s.hide())}),t.TgZ(96,"span",40),t._uU(97,"\xd7"),t.qZA()()(),t.TgZ(98,"div",41)(99,"div",42)(100,"div",43)(101,"input",44),t.NdJ("change",function(s){return e.uploadCSV(s.target.files)}),t.qZA()()(),t.TgZ(102,"button",45),t.NdJ("click",function(){return e.downloadSample()}),t._uU(103),t._UZ(104,"i",46),t.qZA()(),t.TgZ(105,"div",47)(106,"button",20),t.NdJ("click",function(){t.CHM(n);const s=t.MAs(89);return t.KtG(s.hide())}),t._uU(107),t.qZA(),t.TgZ(108,"button",48),t.NdJ("click",function(){return e.saveType()}),t._uU(109),t.qZA()()()()()}2&i&&(t.xp6(6),t.hij(" ",e.util.translate("Offers Information")," "),t.xp6(5),t.Oqu(e.util.translate("Available on")),t.xp6(1),t.Q6J("placeholder",e.util.translate("Select Restaurants"))("data",e.dropdownList)("ngModel",e.selectedItems)("settings",e.dropdownSettings),t.xp6(3),t.Oqu(e.util.translate("Coupon code")),t.xp6(1),t.Tol(e.submited&&""==e.name?"req":""),t.Q6J("ngModel",e.name)("placeholder",e.util.translate("Coupon code"))("ngModelOptions",t.DdM(72,d)),t.xp6(3),t.Oqu(e.util.translate("Discount")),t.xp6(1),t.Tol(e.submited&&""==e.off?"req":""),t.Q6J("ngModel",e.off)("placeholder",e.util.translate("Discount"))("ngModelOptions",t.DdM(73,d)),t.xp6(3),t.Oqu(e.util.translate("Minimum cart value")),t.xp6(1),t.Tol(e.submited&&""==e.min?"req":""),t.Q6J("ngModel",e.min)("placeholder",e.util.translate("Minimum cart value"))("ngModelOptions",t.DdM(74,d)),t.xp6(3),t.Oqu(e.util.translate("Upto")),t.xp6(1),t.Tol(e.submited&&""==e.upto?"req":""),t.Q6J("ngModel",e.upto)("placeholder",e.util.translate("Upto"))("ngModelOptions",t.DdM(75,d)),t.xp6(3),t.Oqu(e.util.translate("Discount Type")),t.xp6(1),t.Tol(e.submited&&""==e.type?"req":""),t.Q6J("ngModel",e.type)("ngModelOptions",t.DdM(76,d)),t.xp6(4),t.Oqu(e.util.translate("Flat")),t.xp6(3),t.Oqu(e.util.translate("Expire date")),t.xp6(1),t.Tol(e.submited&&""==e.date_time?"req":""),t.Q6J("ngModel",e.date_time)("ngModelOptions",t.DdM(77,d))("placeholder",e.util.translate("Expire date")),t.xp6(3),t.Oqu(e.util.translate("Descriptions")),t.xp6(1),t.Tol(e.submited&&""==e.descriptions?"req":""),t.Q6J("ngModel",e.descriptions)("ngModelOptions",t.DdM(78,d))("placeholder",e.util.translate("Descriptions")),t.xp6(4),t.Q6J("ngIf",1==e.isNew),t.xp6(1),t.Q6J("ngIf",0==e.isNew),t.xp6(3),t.hij("",e.util.translate("Clear")," "),t.xp6(4),t.hij(" ",e.util.translate("All Offers")," "),t.xp6(3),t.hij(" ",e.util.translate("Bulk CSV Upload")," "),t.xp6(3),t.hij(" ",e.util.translate("Export as CSV")," "),t.xp6(4),t.Q6J("placeholder",e.util.translate("Search Offer Code")),t.xp6(1),t.Q6J("ngIf",(null==e.list?null:e.list.length)<=0&&(null==e.dummy?null:e.dummy.length)<=0),t.xp6(5),t.hij("",e.util.translate("Id")," "),t.xp6(2),t.hij("",e.util.translate("Coupon code")," "),t.xp6(2),t.hij("",e.util.translate("Discount")," "),t.xp6(2),t.hij("",e.util.translate("Expire")," "),t.xp6(2),t.hij("",e.util.translate("Descriptions")," "),t.xp6(2),t.hij("",e.util.translate("Action")," "),t.xp6(2),t.Q6J("ngForOf",e.dummy),t.xp6(1),t.Q6J("ngForOf",t.xi3(86,69,e.list,t.VKq(79,k,e.page))),t.xp6(2),t.Q6J("ngIf",(null==e.list?null:e.list.length)>0),t.xp6(7),t.hij("",e.util.translate("Bulk CSV Upload")," "),t.xp6(9),t.hij(" ",e.util.translate("Download Sample CSV")," \xa0 "),t.xp6(4),t.Oqu(e.util.translate("Close")),t.xp6(2),t.hij(" ",e.util.translate("Save Changes"),""))},dependencies:[p.sg,p.O5,m.oB,u.YN,u.Kr,u.Fj,u.wV,u.EJ,u.JJ,u.On,_.Ro,c.LS,C.xr,b.FN3,T.O,c._s],styles:['@charset "UTF-8";.flex_row[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{font-size:14px}.help[_ngcontent-%COMP%]{background:lightyellow;font-size:10px;width:max-content;color:red}.req[_ngcontent-%COMP%]{border:1px solid red}']}),o})()}];let I=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[g.Bz.forChild(S),g.Bz]}),o})();var j=a(9241),E=a(835),F=a(6442);let H=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,I,m.zk.forRoot(),u.u5,_.ef,c.JX,C.hx.forRoot({animation:"progress-dark"}),j.P4.forRoot(),E.Fq.forRoot(),b.TXv,F.dF,T.Z]}),o})()}}]);